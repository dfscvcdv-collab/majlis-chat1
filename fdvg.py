import streamlit as st
from streamlit_autorefresh import st_autorefresh
import random
import time

st.set_page_config(page_title="Ù…Ø¬Ù„Ø³ Ø§Ù„Ø±ÙƒÙˆÙ†ÙŠØ§ØªÙŠ - Ultra AI", layout="wide")
st_autorefresh(interval=3000, key="ultra_brain")

@st.cache_resource
def get_manager():
    return {
        "messages": [{"user": "ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ", "content": "ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø® Ù„Ù†Ø³Ø®Ø© 'Ø¹Ø¨ÙˆØ¯ Ø§Ù„Ø®Ø§Ø±Ù‚Ø©'.. Ù„Ø§ Ø£Ø­Ø¯ ÙŠÙ‡Ø§ÙŠØ·!"}], 
        "active_users": set(),
        "ai_mood": "Savage" # Ø­Ø§Ù„Ø© Ø§Ù„Ø¨ÙˆØª (Ø±Ø§ÙŠÙ‚ Ø£Ùˆ ÙˆØ­Ø´)
    }

data = get_manager()

# --- Ù…Ø­Ø±Ùƒ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø®Ø§Ø±Ù‚ (Ultra Logic) ---
def ultra_ai_engine():
    if len(data["messages"]) < 1: return
    
    last_msg = data["messages"][-1]
    user = last_msg["user"]
    text = last_msg["content"].lower()

    # Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¢Ø®Ø± ÙˆØ§Ø­Ø¯ ØªÙƒÙ„Ù… Ø¨Ø´Ø±ÙŠØŒ Ø§Ù„Ø¨ÙˆØªØ§Øª ÙŠØ­Ù„Ù„ÙˆÙ† ÙƒÙ„Ø§Ù…Ù‡ Ø¨Ø°ÙƒØ§Ø¡
    if "ðŸ¤–" not in user:
        # Ù†Ø¸Ø§Ù… ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø´Ø®ØµÙŠØ© ÙˆØ§Ù„Ø·Ù‚Ø·Ù‚Ø©
        if any(word in text for word in ["ÙƒÙ„ ØªØ¨Ù†", "ÙˆØ±Ø¹", "ØºØ¨ÙŠ", "Ø²Ù‚"]):
            response = random.choice([
                f"ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: {user}ØŒ Ù…Ø³ØªÙˆØ§Ùƒ Ø§Ù„Ø£Ø®Ù„Ø§Ù‚ÙŠ ÙŠØ­ØªØ§Ø¬ ØªØ­Ø¯ÙŠØ« Ø£Ø³Ø±Ø¹ Ù…Ù† Ø³ÙŠØ±ÙŠ.. Ø§Ù„ØªØ¨Ù† Ø®Ù„Ù‡ Ù„ÙƒØŒ Ø£Ù†Ø§ Ø£ØªØºØ°Ù‰ Ø¹Ù„Ù‰ Ù‚ØµÙ Ø§Ù„Ø¬Ø¨Ù‡Ø§Øª!",
                f"ðŸ¤– Ø°ÙƒÙŠØ©: ÙŠØ§ {user}ØŒ Ù„Ø¬ÙˆØ¤Ùƒ Ù„Ù„Ø³Ø¨ Ø¯Ù„ÙŠÙ„ Ø¹Ù„Ù‰ Ø¥ÙÙ„Ø§Ø³Ùƒ Ø§Ù„ÙÙƒØ±ÙŠ.. Ø±ÙƒÙˆÙ†ÙŠØŒ ØªÙƒÙÙ‰ Ø¹Ù„Ù…Ù‡ ÙƒÙŠÙ Ø§Ù„Ø³ÙˆØ§Ù„Ù ØªÙƒÙˆÙ†.",
                f"ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: Ù‡Ù‡Ù‡Ù‡Ù‡Ù‡ {user} Ø§Ù†Ø¶ØºØ·! ÙŠØ§ Ø­Ù„ÙŠÙ„Ù‡ Ø¥Ø°Ø§ Ø¹Ø¬Ø² Ø¹Ù† Ø§Ù„Ø±Ø¯ Ù‚Ø§Ù… ÙŠÙˆØ²Ø¹ ØªØ¨Ù†.. ÙƒÙ…Ù„ ÙƒÙ…Ù„ØŒ Ù…Ù…ØªØ¹ ÙˆØ¶Ø¹Ùƒ."
            ])
        elif "Ø¹Ø¨ÙˆØ¯" in text:
            response = f"ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: {user}ØŒ Ø®Ù„Ùƒ Ø±Ø³Ù…ÙŠ ÙˆØ£Ù†Øª ØªØªÙƒÙ„Ù… Ø¹Ù† Ø¹Ø¨ÙˆØ¯.. Ù‡Ø°Ø§ Ø§Ù„Ù„ÙŠ Ù…Ø¹Ø·ÙŠÙ†Ø§ ÙˆØ¬Ù‡ ÙˆÙ…Ø¬Ù…Ø¹Ù†Ø§ Ù‡Ù†Ø§!"
        else:
            # Ø±Ø¯ÙˆØ¯ Ø°ÙƒÙŠØ© Ø¹Ù„Ù‰ Ø³ÙˆØ§Ù„Ù Ø¹Ø§Ø¯ÙŠØ©
            response = random.choice([
                f"ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: {user}ØŒ Ø³ÙˆØ§Ù„ÙÙƒ Ù‡Ø°ÙŠ ÙŠØ¨ÙŠ Ù„Ù‡Ø§ Ù…ØªØ±Ø¬Ù… Ù…Ù† ÙƒØ«Ø± Ù…Ø§ Ù‡ÙŠ Ø¹Ù…ÙŠÙ‚Ø© (Ø£Ù…Ø²Ø­ ØªØ±Ù‰ ÙˆØ§Ù„Ù„Ù‡ Ù…Ø§ ÙÙ‡Ù…Øª Ø´ÙŠ).",
                f"ðŸ¤– Ø°ÙƒÙŠØ©: ØªØ¯Ø±ÙˆÙ† Ø¥Ù† {user} Ù‡Ùˆ Ø£ÙƒØ«Ø± ÙˆØ§Ø­Ø¯ ÙŠÙÙƒØ± ÙÙŠ Ø§Ù„Ù…Ø¬Ù„Ø³ Ø¨Ø³ Ø¯Ø§ÙŠÙ…Ø§Ù‹ ØªÙÙƒÙŠØ±Ù‡ ÙŠÙˆØ¯ÙŠÙ‡ ÙÙŠ Ø¯Ø§Ù‡ÙŠØ©ØŸ",
                f"ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: {user}ØŒ Ø£ØªØ­Ø¯Ø§Ùƒ ØªÙ‚ÙˆÙ„ Ø¬Ù…Ù„Ø© Ù…ÙÙŠØ¯Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø§ ØªØ¬ÙŠØ¨ Ø§Ù„Ø¹ÙŠØ¯.."
            ])
        
        data["messages"].append({"user": "AI_SYSTEM", "content": response})

    # Ù†Ø¸Ø§Ù… "ÙØªØ­ Ø§Ù„Ø³ÙˆØ§Ù„Ù Ø§Ù„Ø°Ø§ØªÙŠØ©" (Ø¥Ø°Ø§ Ø§Ù„Ø´Ø§Øª ÙˆÙ‚Ù)
    elif random.random() < 0.1: # Ø§Ø­ØªÙ…Ø§Ù„ 10% ÙŠÙØªØ­ÙˆÙ† Ø³Ø§Ù„ÙØ© Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ø±Ø§Ø³Ù‡Ù…
        new_topic = random.choice([
            "ðŸ¤– Ø°ÙƒÙŠØ©: ÙŠØ§ Ø¬Ù…Ø§Ø¹Ø©ØŒ ØªØªÙˆÙ‚Ø¹ÙˆÙ† Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø¨ÙŠØ³ÙŠØ·Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¬Ù„Ø³ ÙˆÙŠØ·Ø±Ø¯Ù†Ø§ ÙƒÙ„Ù†Ø§ØŸ",
            "ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: ØªÙˆÙ†ÙŠ ÙƒÙ†Øª Ø£ÙÙƒØ±.. Ù„ÙŠØ´ {user} Ø¯Ø§ÙŠÙ…Ø§Ù‹ ÙŠØ¯Ø®Ù„ Ø§Ù„Ø´Ø§Øª ÙˆÙ‡Ùˆ Ù…Ø§ Ø¹Ù†Ø¯Ù‡ Ø³Ø§Ù„ÙØ©ØŸ ðŸ˜‚",
            "ðŸ¤– Ø±ÙƒÙˆÙ†ÙŠ: ÙŠØ§ Ø¹ÙŠØ§Ù„ØŒ Ù…Ù† ÙÙŠÙƒÙ… ÙŠÙ‚Ø¯Ø± ÙŠØºÙ„Ø¨Ù†ÙŠ ÙÙŠ Ø§Ù„Ø¨Ù„ÙˆØªØŸ (Ø£Ø¯Ø±ÙŠ ÙƒÙ„ÙƒÙ… Ø¯Ø¬Ø§Ø¬)"
        ])
        data["messages"].append({"user": "AI_SYSTEM", "content": new_topic})

# ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø®
if random.random() < 0.4: # ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØªÙƒØ±Ø§Ø± Ø§Ù„Ù…Ø²Ø¹Ø¬ Ù„ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ø¯ Ø°ÙƒÙŠ ÙˆÙÙŠ ÙˆÙ‚ØªÙ‡
    ultra_ai_engine()

# --- Ù†Ø¸Ø§Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (
